<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>单个canvas下钻</title>
    <style>
        #main {
            width: 650px;
            height: 650px;
            background-color: #ccc;
        }
        .box{
            width:200px;
            height: 200px;
            background-color: red;
        }
    </style>
</head>

<body>
    <div id="main"></div>
    <div class="box"></div>
    <script src="./node_modules/jquery/dist/jquery.min.js"></script>
    <script src="./node_modules/echarts/dist/echarts.min.js"></script>
    <script>
        $().ready(function () {
            var box=document.getElementsByClassName('box')[0];
        box.click=function(){
            console.log(1)
        }
        box.dblclick=function(){
            console.log(2);
        }
            $.get('json/china.json', function (mapJson) {
                echarts.registerMap('china', mapJson);
                var options = [];
                var chart = echarts.init(document.getElementById('main'));
                chart.setOption({
                    timeline: {
                        axisType: 'category',
                        data: [1988, 1992, 1996, 2000, 2004, 2008, 2012],
                        autoPlay: false,
                        playInterval: 2000,
                        left: '10%',
                        right: '10%',
                        zlevel: 100
                    },
                    baseOption: {
                        visualMap: {
                            type: 'continuous',
                            max: 50,
                            min: 0,
                            left: '10%',
                            bottom: '10%',
                            itemWidth: 20,
                            itemHeight: 140,
                            show: true,
                            calculable: true,
                            inRange: {
                                color: ['#121122', 'rgba(3,4,5,0.4)', 'red']
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: function (result) { //回调函数，参数params具体格式参加官方API
                                return result.name + '<br />数据:' + result.value;
                            },
                            series: [{
                                type: 'map',
                                name: '总奖牌数',
                                map: 'world',
                                roam: true,
                                // nameMap: nameMap
                            }]
                        },
                        dataRange: {
                            min: 0,
                            max: 50,
                            splitNumber: 0,
                            text: ['高', '低'],
                            realtime: false,
                            calculable: false,
                            selectedMode: false,
                            realtime: false,
                            show: true,
                            itemWidth: 20,
                            itemHeight: 100,
                            color: ['green', '#f2f2f2']
                        },
                        title: {
                            text: '全国数据总览',
                            //subtext:'',
                            x: 'center',
                            y: 'top',
                            textAlign: 'left'
                        },
                        series: [{
                            type: 'map',
                            map: 'china', //要和echarts.registerMap（）中第一个参数一致
                            scaleLimit: {
                                min: 0.8,
                                max: 1.9
                            }, //缩放
                            mapLocation: {
                                y: 60
                            },
                            itemSytle: {
                                emphasis: {
                                    label: {
                                        show: false
                                    }
                                }
                            },
                            label: {
                                normal: {
                                    show: true
                                },
                                emphasis: {
                                    show: true
                                }
                            },
                            // data: options
                            //dataParam//人口数据：例如[{name:'济南',value:'100万'},{name:'菏泽'，value:'100万'}......]
                        }]
                    },
                    //timelene.data中的每一项，对应于options数组中的每个option
                    options: options
                });
                chart.on('click',function(){
                    console.log(1);
                })
                chart.on('dblclick', function (result) {
                    console.log(this)
                    if (result.componentSubType != "map") {
                        return
                    };
                    //选择省的单击事件
                    var selectProe = result.name;
                    $.get('json/' + selectProe + '/' + selectProe + '.json', function (Citymap) {
                        echarts.registerMap(selectProe, Citymap);
                        var myChartProe = echarts.init(document.getElementById(
                            'main'));
                        myChartProe.setOption({
                            tooltip: {
                                trigger: 'item',
                                formatter: function loadData(result) { //回调函数，参数params具体格式参加官方API
                                    return result.name + '<br />数据:' +
                                        result.value;
                                }
                            },
                            dataRange: {
                                min: 0,
                                max: 50,
                                text: ['高', '低'],
                                realtime: false,
                                calculable: false,
                                splitNumber: 0,
                                itemWidth: 10,
                                show: false,
                                itemHeight: 60,
                                color: ['lightskyblue', '#f2f2f2']
                            },
                            title: {
                                text: selectProe + '数据总览',
                                //subtext:'',
                                x: 'center',
                                y: 'top',
                                textAlign: 'left'
                            },
                            series: [{
                                type: 'map',
                                map: selectProe, //要和echarts.registerMap（）中第一个参数一致
                                zlevel: 2,
                                scaleLimit: {
                                    min: 0.8,
                                    max: 1.9
                                }, //缩放
                                mapLocation: {
                                    y: 60
                                },
                                itemSytle: {
                                    emphasis: {
                                        label: {
                                            show: false
                                        }
                                    }
                                },
                                label: {
                                    normal: {
                                        show: true
                                    },
                                    emphasis: {
                                        show: true
                                    }
                                },
                                data: [{
                                        name: '大方县',
                                        value: '5'
                                    },
                                    {
                                        name: '金沙县',
                                        value: '0'
                                    },
                                    {
                                        name: '织金县',
                                        value: '10'
                                    },
                                    {
                                        name: '七星关区',
                                        value: '30'
                                    },
                                    {
                                        name: '纳雍县',
                                        value: '50'
                                    },
                                    {
                                        name: '赫章县',
                                        value: '15'
                                    }
                                ] //dataParam//人口数据：例如[{name:'济南',value:'100万'},{name:'菏泽'，value:'100万'}......]
                            }]
                        })
                        //下钻到市
                        myChartProe.on('click', function (rel) {
                            console.log(this);
                        })
                    });
                })
            })
        })
        

    </script>

    <script>
        function changeMap() {
            var myChart = echarts.init(document.getElementById('map'));
            option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}'
                },
                series: [{
                    name: '中国',
                    type: 'map',
                    mapType: 'china',
                    selectedMode: 'single',
                    label: {
                        normal: {
                            show: true
                        },
                        emphasis: {
                            show: true
                        }
                    },
                    data: [

                    ]
                }]
            };
            var Province = "";
            myChart.on('click', function (params) {
                var myChart = echarts.init(document.getElementById('map'));
                Province = params.name;
                option = {
                    tooltip: {
                        trigger: 'item',
                        formatter: '{b}'
                    },
                    series: [{
                        name: '中国',
                        type: 'map',
                        mapType: Province,
                        selectedMode: 'single',
                        label: {
                            normal: {
                                show: true
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        data: [

                        ]
                    }]
                };
                myChart.on('click', function (params) {
                    changeMap();
                });
                myChart.setOption(option);
                window.addEventListener("resize", function () {
                    myChart.resize();
                });
            });

            myChart.setOption(option);
            window.addEventListener("resize", function () {
                myChart.resize();
            });
        }
    </script>
</body>

</html>